version: 2

models:
  - name: fct_claims
    group: healthcare_analytics
    access: public
    description: "The fct_claims model aggregates data at the claim level, incorporating details from both patients and providers tables. This model enables deep insights into claim patterns and provider performance, facilitating informed decision-making in healthcare management and policy formulation. It is optimized for Snowflake, providing a robust platform for data analytics and reporting."
    config:
      contract:
        enforced: true
    meta:
        owner: 'Healthcare Data Analyst'
    columns:
      - name: claim_id
        data_type: number
        constraints:
          - type: not_null
        description: "The unique identifier for each claim."

      - name: patient_id
        data_type: number
        constraints:
          - type: not_null
        description: "The unique identifier for each patient."

      - name: patient_name
        data_type: varchar
        constraints:
          - type: not_null
        description: "The full name of the patient."

      - name: provider_id
        data_type: number
        constraints:
          - type: not_null
        description: "The unique identifier for each provider."

      - name: provider_name
        data_type: varchar
        constraints:
          - type: not_null
        description: "The full name of the provider."

      - name: specialty
        data_type: varchar
        description: "The specialty of the provider."

      - name: claim_date
        data_type: date
        constraints:
          - type: not_null
        description: "The date on which the claim was made."

      - name: claim_amount
        data_type: number
        constraints:
          - type: not_null
        description: "The amount claimed."

      - name: total_claim_amount
        data_type: number
        description: "The total claim amount for each provider."

      - name: avg_claim_amount
        data_type: number
        description: "The average claim amount for each provider."

      - name: claim_count
        data_type: number
        description: "The count of claims made to each provider."

semantic_models:
  - name: fct_claims
    defaults:
      agg_time_dimension: claim_date
    description: |
      The claims analytics model offers a comprehensive view of healthcare claims data, incorporating key metrics such as claim amounts and counts, and average claim amounts, all partitioned by provider. This helps in understanding the claim patterns and assists in healthcare management and policy formulation.
    model: ref('fct_claims')
    entities:
      - name: claim
        type: primary
        expr: claim_id
      - name: patient
        type: foreign
        expr: patient_id
      - name: provider
        type: foreign
        expr: provider_id
    dimensions:
      - name: claim_date
        expr: claim_date
        type: time
        type_params:
          time_granularity: day
      - name: provider_name
        expr: provider_name
        type: categorical
      - name: specialty
        expr: specialty
        type: categorical
    measures:
      - name: total_claim_amount
        description: The total claim amount associated with each provider, calculated as the sum of individual claim amounts.
        agg: sum
        expr: total_claim_amount
      - name: avg_claim_amount
        description: The average claim amount per provider, calculated as the total claim amount divided by the number of claims.
        agg: average
        expr: avg_claim_amount
      - name: claim_count
        description: The total number of claims associated with each provider.
        agg: count
        expr: claim_count

metrics:
  - name: total_revenue
    description: The total revenue generated through claims, calculated as the sum of the total claim amounts across all providers.
    type: simple
    label: Total Revenue
    type_params:
      measure: total_claim_amount
  - name: total_claims
    description: The total number of claims made across all providers.
    type: simple
    label: Total Claims
    type_params:
      measure: claim_count
